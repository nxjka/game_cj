<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¯­è¨€åŠ å¯†ä¸çŸ©é˜µå›¾åƒè½¬æ¢ç³»ç»Ÿ - å®Œæ•´åŠ è§£å¯†</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e6e6e6;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        h1 {
            color: #00d4ff;
            margin-bottom: 10px;
            font-size: 2.5em;
            text-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
        }
        
        .subtitle {
            color: #888;
            font-size: 1.1em;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .card-title {
            color: #00d4ff;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(0, 212, 255, 0.3);
            font-size: 1.4em;
        }
        
        textarea, input[type="text"] {
            width: 100%;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: white;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
            margin-bottom: 15px;
            transition: border-color 0.3s ease;
        }
        
        textarea:focus, input:focus {
            outline: none;
            border-color: #00d4ff;
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        
        button {
            padding: 12px 24px;
            background: linear-gradient(135deg, #00d4ff 0%, #0077ff 100%);
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 120px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 212, 255, 0.4);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #666 0%, #444 100%);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #00cc66 0%, #00994d 100%);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ff9900 0%, #cc7700 100%);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ff3333 0%, #cc0000 100%);
        }
        
        .result-container {
            margin-top: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .result-title {
            color: #00ff88;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .binary-display {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            word-break: break-all;
            color: #00ff88;
        }
        
        .hex-display {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            word-break: break-all;
            color: #ff9900;
        }
        
        .decrypted-display {
            font-family: 'Courier New', monospace;
            font-size: 14px;
            word-break: break-all;
            color: #00ff88;
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            border-left: 4px solid #00cc66;
        }
        
        .matrix-container {
            grid-column: 1 / -1;
            margin-top: 20px;
        }
        
        .canvas-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            align-items: flex-start;
        }
        
        .canvas-wrapper {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }
        
        .canvas-wrapper h3 {
            color: #ff9900;
            margin-bottom: 10px;
        }
        
        canvas {
            border-radius: 8px;
            background: #000;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
            position: relative;
        }
        
        .step {
            text-align: center;
            flex: 1;
            position: relative;
            z-index: 1;
        }
        
        .step-number {
            width: 40px;
            height: 40px;
            background: #333;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            color: #888;
            transition: all 0.3s ease;
        }
        
        .step.active .step-number {
            background: #00d4ff;
            color: white;
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.5);
        }
        
        .step-line {
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 2px;
            background: #333;
            z-index: 0;
        }
        
        .status-bar {
            margin-top: 20px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .progress-bar {
            flex: 1;
            height: 8px;
            background: #333;
            border-radius: 4px;
            overflow: hidden;
            margin: 0 20px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00d4ff, #0077ff);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top-color: #00d4ff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .matrix-info {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .info-box {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            padding: 15px;
            flex: 1;
            min-width: 200px;
        }
        
        .info-box h4 {
            color: #ff9900;
            margin-bottom: 10px;
        }
        
        .pixel-grid {
            display: grid;
            gap: 1px;
            margin: 20px auto;
            max-width: 400px;
            max-height: 400px;
            overflow: auto;
        }
        
        .pixel {
            width: 10px;
            height: 10px;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        
        .download-btn {
            background: linear-gradient(135deg, #ff6600 0%, #cc5500 100%);
        }
        
        .data-analysis {
            margin-top: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 20px;
        }
        
        .analysis-row {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .analysis-item {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            padding: 10px 15px;
            flex: 1;
            min-width: 120px;
        }
        
        .analysis-item .label {
            color: #888;
            font-size: 0.9em;
            margin-bottom: 5px;
        }
        
        .analysis-item .value {
            color: #00d4ff;
            font-weight: bold;
            font-size: 1.1em;
        }
        
        .chart-container {
            margin-top: 20px;
            height: 200px;
            position: relative;
        }
        
        .bar-chart {
            display: flex;
            align-items: flex-end;
            height: 100%;
            gap: 2px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }
        
        .bar {
            flex: 1;
            background: linear-gradient(to top, #00d4ff, #0077ff);
            border-radius: 3px 3px 0 0;
            min-height: 1px;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .tab {
            padding: 12px 24px;
            background: transparent;
            border: none;
            color: #888;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .tab.active {
            color: #00d4ff;
        }
        
        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: #00d4ff;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .decryption-area {
            margin-top: 20px;
        }
        
        .file-upload {
            margin-bottom: 20px;
            text-align: center;
            padding: 20px;
            border: 2px dashed rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .file-upload:hover {
            border-color: #00d4ff;
            background: rgba(0, 212, 255, 0.05);
        }
        
        .comparison {
            margin-top: 30px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            border-left: 4px solid #00cc66;
        }
        
        .comparison h3 {
            color: #00cc66;
            margin-bottom: 15px;
        }
        
        .comparison-row {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .comparison-item {
            flex: 1;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
        }
        
        .comparison-label {
            color: #888;
            font-size: 0.9em;
            margin-bottom: 5px;
        }
        
        .comparison-value {
            color: white;
            font-size: 1.1em;
            font-weight: bold;
        }
        
        .match {
            color: #00cc66;
        }
        
        .mismatch {
            color: #ff3333;
        }
        
        .key-display {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-top: 10px;
            border-left: 4px solid #ff9900;
        }
        
        .key-display h4 {
            color: #ff9900;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ” è¯­è¨€åŠ å¯†ä¸çŸ©é˜µå›¾åƒè½¬æ¢ç³»ç»Ÿ - å®Œæ•´åŠ è§£å¯†</h1>
            <p class="subtitle">åŸºäºGB2312ç¼–ç ã€äºŒè¿›åˆ¶è¿ç®—å’ŒçŸ©é˜µå›¾åƒè½¬æ¢çš„å®Œæ•´åŠ è§£å¯†ç³»ç»Ÿ</p>
        </header>
        
        <div class="tabs">
            <button class="tab active" onclick="switchTab('encrypt')">ğŸ”’ åŠ å¯†</button>
            <button class="tab" onclick="switchTab('decrypt')">ğŸ”“ è§£å¯†</button>
            <button class="tab" onclick="switchTab('compare')">âš–ï¸ å¯¹æ¯”</button>
        </div>
        
        <div id="encrypt-tab" class="tab-content active">
            <div class="step-indicator">
                <div class="step-line"></div>
                <div class="step active">
                    <div class="step-number">1</div>
                    <div>æ–‡æœ¬è¾“å…¥</div>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <div>ç¼–ç è½¬æ¢</div>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <div>äºŒè¿›åˆ¶åŠ å¯†</div>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <div>çŸ©é˜µå›¾åƒ</div>
                </div>
            </div>
            
            <div class="main-content">
                <div class="card">
                    <h2 class="card-title">è¾“å…¥åŒºåŸŸ</h2>
                    <textarea id="inputText" placeholder="è¯·è¾“å…¥è¦åŠ å¯†çš„æ–‡æœ¬..." rows="6">ä½ å¥½ï¼Œä¸–ç•Œï¼Hello World! è¿™æ˜¯ä¸€ä¸ªåŠ å¯†æµ‹è¯•ã€‚</textarea>
                    
                    <div class="btn-group">
                        <button onclick="encryptText()">ğŸš€ å¼€å§‹åŠ å¯†</button>
                        <button onclick="resetAll()" class="btn-secondary">ğŸ”„ é‡ç½®</button>
                        <button onclick="randomExample()" class="btn-secondary">ğŸ² éšæœºç¤ºä¾‹</button>
                        <button onclick="testLongText()" class="btn-warning">ğŸ“ é•¿æ–‡æœ¬æµ‹è¯•</button>
                    </div>
                    
                    <div class="loading" id="loading">
                        <div class="spinner"></div>
                        <div>æ­£åœ¨å¤„ç†åŠ å¯†å’Œå›¾åƒè½¬æ¢...</div>
                    </div>
                </div>
                
                <div class="card">
                    <h2 class="card-title">åŠ å¯†è¿‡ç¨‹è¯¦æƒ…</h2>
                    <div id="processDetails">
                        <div class="process-step">
                            <div class="result-title">åŸå§‹æ–‡æœ¬:</div>
                            <div id="originalText" class="binary-display">ç­‰å¾…è¾“å…¥...</div>
                        </div>
                        <div class="process-step">
                            <div class="result-title">GB2312 ç¼–ç :</div>
                            <div id="gb2312Encoding" class="hex-display">ç­‰å¾…å¤„ç†...</div>
                        </div>
                        <div class="process-step">
                            <div class="result-title">éšæœºäºŒè¿›åˆ¶å¯†é’¥:</div>
                            <div id="randomKey" class="binary-display">ç­‰å¾…ç”Ÿæˆ...</div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <h2 class="card-title">äºŒè¿›åˆ¶æ“ä½œç»“æœ</h2>
                    <div class="process-step">
                        <div class="result-title">å¼‚æˆ–è¿ç®—ç»“æœ(åå…­è¿›åˆ¶):</div>
                        <div id="xorResult" class="hex-display">ç­‰å¾…è®¡ç®—...</div>
                    </div>
                    <div class="process-step">
                        <div class="result-title">æœ€ç»ˆåŠ å¯†æ•°æ®:</div>
                        <div id="finalEncrypted" class="hex-display">ç­‰å¾…è®¡ç®—...</div>
                    </div>
                </div>
                
                <div class="card">
                    <h2 class="card-title">çŸ©é˜µå›¾åƒæ•°æ®</h2>
                    <div class="process-step">
                        <div class="result-title">åè¿›åˆ¶åºåˆ—:</div>
                        <div id="decimalSequence" class="binary-display">ç­‰å¾…ç”Ÿæˆ...</div>
                    </div>
                    <div class="process-step">
                        <div class="result-title">è¡¥0ååºåˆ—:</div>
                        <div id="paddedSequenceDisplay" class="binary-display">ç­‰å¾…è®¡ç®—...</div>
                    </div>
                    <div class="process-step">
                        <div class="result-title">çŸ©é˜µä¿¡æ¯:</div>
                        <div id="matrixInfo" class="binary-display">ç­‰å¾…è®¡ç®—...</div>
                    </div>
                </div>
            </div>
            
            <div class="card matrix-container">
                <h2 class="card-title">çŸ©é˜µå›¾åƒå¯è§†åŒ–</h2>
                
                <div class="matrix-info">
                    <div class="info-box">
                        <h4>åŸå§‹æ•°æ®ä¿¡æ¯</h4>
                        <div>åè¿›åˆ¶ç‚¹æ•°: <span id="dataCount">0</span></div>
                        <div>æœ€è¿‘å¹³æ–¹æ•°: <span id="nearestSquare">0</span></div>
                        <div>è¡¥0åç‚¹æ•°: <span id="paddedCount">0</span></div>
                        <div>çŸ©é˜µç»´åº¦: <span id="matrixSize">0Ã—0</span></div>
                        <div>è¡¥0æ•°é‡: <span id="zerosAdded">0</span></div>
                    </div>
                    
                    <div class="info-box">
                        <h4>å›¾åƒå‚æ•°</h4>
                        <div>å›¾åƒå°ºå¯¸: <span id="imageSize">0Ã—0 åƒç´ </span></div>
                        <div>åƒç´ æ€»æ•°: <span id="pixelCount">0</span></div>
                        <div>å¡«å……æ¯”ä¾‹: <span id="fillRatio">0%</span></div>
                        <div>æ•°æ®å¯†åº¦: <span id="dataDensity">0%</span></div>
                    </div>
                    
                    <div class="info-box">
                        <h4>æ•°æ®ç»Ÿè®¡</h4>
                        <div>å¹³å‡ç°åº¦: <span id="avgGray">0</span></div>
                        <div>æœ€å°/æœ€å¤§: <span id="minMax">0/0</span></div>
                        <div>æ ‡å‡†å·®: <span id="stdDev">0</span></div>
                        <div>æ•°æ®ç†µ: <span id="dataEntropy">0</span></div>
                    </div>
                </div>
                
                <div class="data-analysis">
                    <h4 style="color: #ff9900; margin-bottom: 15px;">æ•°æ®åˆ†å¸ƒåˆ†æ</h4>
                    <div class="analysis-row">
                        <div class="analysis-item">
                            <div class="label">éé›¶å€¼</div>
                            <div class="value" id="nonZeroCount">0</div>
                        </div>
                        <div class="analysis-item">
                            <div class="label">é›¶å€¼</div>
                            <div class="value" id="zeroCount">0</div>
                        </div>
                        <div class="analysis-item">
                            <div class="label">é›¶å€¼æ¯”ä¾‹</div>
                            <div class="value" id="zeroRatio">0%</div>
                        </div>
                        <div class="analysis-item">
                            <div class="label">ä¸­ä½æ•°</div>
                            <div class="value" id="medianValue">0</div>
                        </div>
                        <div class="analysis-item">
                            <div class="label">ä¼—æ•°</div>
                            <div class="value" id="modeValue">0</div>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <h4 style="color: #ff9900; margin-bottom: 10px;">æ•°å€¼åˆ†å¸ƒç›´æ–¹å›¾</h4>
                        <div class="bar-chart" id="histogramChart"></div>
                    </div>
                </div>
                
                <div class="canvas-container">
                    <div class="canvas-wrapper">
                        <h3>åŸå§‹æ³¢å½¢</h3>
                        <canvas id="waveformCanvas" width="500" height="350"></canvas>
                    </div>
                    
                    <div class="canvas-wrapper">
                        <h3>çŸ©é˜µå›¾åƒ</h3>
                        <canvas id="matrixCanvas" width="500" height="350"></canvas>
                        <div class="controls">
                            <button onclick="downloadImage()" class="download-btn">ğŸ’¾ ä¸‹è½½å›¾åƒ</button>
                            <button onclick="downloadEncryptionData()" class="btn-success">ğŸ“¥ ä¸‹è½½åŠ å¯†æ•°æ®</button>
                            <button onclick="zoomIn()">ğŸ” æ”¾å¤§</button>
                            <button onclick="zoomOut()">ğŸ” ç¼©å°</button>
                            <button onclick="toggleGrid()">ğŸ“Š ç½‘æ ¼</button>
                            <button onclick="toggleHeatmap()">ğŸ”¥ çƒ­åŠ›å›¾</button>
                        </div>
                    </div>
                </div>
                
                <div class="key-display">
                    <h4>åŠ å¯†å¯†é’¥ä¿¡æ¯</h4>
                    <div>å¯†é’¥é•¿åº¦: <span id="keyLength">0</span> ä½</div>
                    <div>å¯†é’¥åå…­è¿›åˆ¶: <span id="keyHex">ç­‰å¾…ç”Ÿæˆ...</span></div>
                    <div>å¯†é’¥å“ˆå¸Œ: <span id="keyHash">ç­‰å¾…ç”Ÿæˆ...</span></div>
                    <div>å¯†é’¥ID: <span id="keyId">ç­‰å¾…ç”Ÿæˆ...</span></div>
                </div>
            </div>
        </div>
        
        <div id="decrypt-tab" class="tab-content">
            <div class="card">
                <h2 class="card-title">è§£å¯†åŒºåŸŸ</h2>
                
                <div class="btn-group">
                    <button onclick="loadEncryptionData()" class="btn-success">ğŸ“‚ åŠ è½½åŠ å¯†æ•°æ®</button>
                    <button onclick="loadImageData()" class="btn-warning">ğŸ–¼ï¸ åŠ è½½å›¾åƒæ•°æ®</button>
                    <button onclick="decryptFromMatrix()" class="btn-danger">ğŸ”“ å¼€å§‹è§£å¯†</button>
                </div>
                
                <div class="file-upload" onclick="document.getElementById('fileInput').click()">
                    <h3>ğŸ“ ä¸Šä¼ åŠ å¯†æ•°æ®æ–‡ä»¶æˆ–å›¾åƒæ–‡ä»¶</h3>
                    <p>ç‚¹å‡»æ­¤å¤„ä¸Šä¼ ä¹‹å‰ä¸‹è½½çš„åŠ å¯†æ•°æ®æ–‡ä»¶(.json)æˆ–çŸ©é˜µå›¾åƒæ–‡ä»¶(.png)</p>
                    <input type="file" id="fileInput" accept=".json,.png,.jpg,.jpeg" style="display: none;" onchange="handleFileUpload(this.files)">
                </div>
                
                <div class="loading" id="decryptLoading">
                    <div class="spinner"></div>
                    <div>æ­£åœ¨å¤„ç†è§£å¯†...</div>
                </div>
                
                <div id="decryptionResult" style="display: none;">
                    <h3 style="color: #00cc66; margin-bottom: 15px;">è§£å¯†ç»“æœ</h3>
                    <div class="decrypted-display" id="decryptedText">ç­‰å¾…è§£å¯†...</div>
                    
                    <div class="key-display" style="margin-top: 20px;">
                        <h4>ä½¿ç”¨çš„å¯†é’¥ä¿¡æ¯</h4>
                        <div>å¯†é’¥é•¿åº¦: <span id="decryptKeyLength">0</span> ä½</div>
                        <div>å¯†é’¥åå…­è¿›åˆ¶: <span id="decryptKeyHex">ç­‰å¾…æå–...</span></div>
                        <div>å¯†é’¥åŒ¹é…: <span id="keyMatchStatus">æœªçŸ¥</span></div>
                    </div>
                    
                    <div class="result-container" style="margin-top: 20px;">
                        <div class="result-title">è§£å¯†è¿‡ç¨‹è¯¦æƒ…:</div>
                        <div id="decryptProcess" class="binary-display">ç­‰å¾…å¤„ç†...</div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h2 class="card-title">è§£å¯†è¿‡ç¨‹å¯è§†åŒ–</h2>
                <div class="canvas-container">
                    <div class="canvas-wrapper">
                        <h3>åŠ è½½çš„å›¾åƒ</h3>
                        <canvas id="loadedImageCanvas" width="400" height="300"></canvas>
                    </div>
                    
                    <div class="canvas-wrapper">
                        <h3>æå–çš„çŸ©é˜µ</h3>
                        <canvas id="extractedMatrixCanvas" width="400" height="300"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="compare-tab" class="tab-content">
            <div class="comparison">
                <h3>ğŸ” åŠ è§£å¯†å¯¹æ¯”åˆ†æ</h3>
                <div class="comparison-row">
                    <div class="comparison-item">
                        <div class="comparison-label">åŸå§‹æ–‡æœ¬é•¿åº¦</div>
                        <div class="comparison-value" id="compareOriginalLength">0 å­—ç¬¦</div>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-label">è§£å¯†æ–‡æœ¬é•¿åº¦</div>
                        <div class="comparison-value" id="compareDecryptedLength">0 å­—ç¬¦</div>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-label">åŒ¹é…çŠ¶æ€</div>
                        <div class="comparison-value" id="compareMatchStatus">æœªæµ‹è¯•</div>
                    </div>
                </div>
                
                <div class="comparison-row">
                    <div class="comparison-item">
                        <div class="comparison-label">åŸå§‹æ–‡æœ¬å“ˆå¸Œ</div>
                        <div class="comparison-value" id="compareOriginalHash">ç­‰å¾…è®¡ç®—...</div>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-label">è§£å¯†æ–‡æœ¬å“ˆå¸Œ</div>
                        <div class="comparison-value" id="compareDecryptedHash">ç­‰å¾…è®¡ç®—...</div>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-label">å“ˆå¸ŒåŒ¹é…</div>
                        <div class="comparison-value" id="compareHashMatch">æœªæµ‹è¯•</div>
                    </div>
                </div>
                
                <div class="result-container" style="margin-top: 20px;">
                    <div class="result-title">å­—ç¬¦çº§å¯¹æ¯”:</div>
                    <div id="charComparison" class="binary-display">ç­‰å¾…å¯¹æ¯”...</div>
                </div>
            </div>
        </div>
        
        <div class="status-bar">
            <div id="statusText">å‡†å¤‡å°±ç»ª</div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div id="dataSize">æ•°æ®å¤§å°: 0 bytes</div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let encryptionData = {
            originalText: '',
            gb2312Bytes: null,
            binaryString: '',
            randomBinary: '',
            xorResult: '',
            finalHex: '',
            decimalSequence: [],
            paddedSequence: [],
            matrixData: null,
            matrixSize: 0,
            heatmapMode: false,
            zoomLevel: 1.5,
            showGrid: true,
            encryptionKey: null,
            keyId: '',
            timestamp: null
        };

        let decryptionData = {
            loadedImage: null,
            extractedMatrix: null,
            extractedSequence: [],
            decryptedText: '',
            decryptionKey: null,
            success: false
        };

        // åˆ‡æ¢æ ‡ç­¾é¡µ
        function switchTab(tabName) {
            // æ›´æ–°æ ‡ç­¾
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // æ¿€æ´»é€‰ä¸­çš„æ ‡ç­¾
            document.querySelector(`[onclick="switchTab('${tabName}')"]`).classList.add('active');
            document.getElementById(`${tabName}-tab`).classList.add('active');
        }

        // æ›´æ–°æ­¥éª¤æŒ‡ç¤ºå™¨
        function updateStepIndicator(step) {
            const steps = document.querySelectorAll('.step');
            steps.forEach((s, index) => {
                if (index < step) {
                    s.classList.add('active');
                } else {
                    s.classList.remove('active');
                }
            });
            
            const progress = (step / 4) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        // æ›´æ–°çŠ¶æ€
        function updateStatus(text) {
            document.getElementById('statusText').textContent = text;
        }

        // æ˜¾ç¤º/éšè—åŠ è½½åŠ¨ç”»
        function toggleLoading(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
        }

        function toggleDecryptLoading(show) {
            document.getElementById('decryptLoading').style.display = show ? 'block' : 'none';
        }

        // å­—ç¬¦ä¸²è½¬GB2312å­—èŠ‚æ•°ç»„
        function stringToGB2312(str) {
            const bytes = [];
            for (let i = 0; i < str.length; i++) {
                const charCode = str.charCodeAt(i);
                if (charCode <= 0x7F) {
                    bytes.push(charCode);
                } else {
                    try {
                        const encoder = new TextEncoder('gb2312');
                        const encoded = encoder.encode(str[i]);
                        bytes.push(...encoded);
                    } catch {
                        bytes.push(0x3F);
                    }
                }
            }
            return new Uint8Array(bytes);
        }

        // GB2312å­—èŠ‚æ•°ç»„è½¬å­—ç¬¦ä¸²
        function gb2312ToString(bytes) {
            try {
                const decoder = new TextDecoder('gb2312');
                return decoder.decode(bytes);
            } catch (e) {
                // å¦‚æœè§£ç å¤±è´¥ï¼Œä½¿ç”¨å›é€€æ–¹æ³•
                let result = '';
                for (let i = 0; i < bytes.length; i++) {
                    if (bytes[i] <= 0x7F) {
                        result += String.fromCharCode(bytes[i]);
                    } else {
                        result += '?';
                    }
                }
                return result;
            }
        }

        // å­—èŠ‚æ•°ç»„è½¬äºŒè¿›åˆ¶å­—ç¬¦ä¸²
        function bytesToBinary(bytes) {
            let binary = '';
            for (let byte of bytes) {
                binary += byte.toString(2).padStart(8, '0');
            }
            return binary;
        }

        // äºŒè¿›åˆ¶å­—ç¬¦ä¸²è½¬å­—èŠ‚æ•°ç»„
        function binaryToBytes(binary) {
            const bytes = [];
            for (let i = 0; i < binary.length; i += 8) {
                const byteStr = binary.substr(i, 8);
                bytes.push(parseInt(byteStr, 2));
            }
            return new Uint8Array(bytes);
        }

        // ç”ŸæˆéšæœºäºŒè¿›åˆ¶åºåˆ—
        function generateRandomBinary(length) {
            let random = '';
            for (let i = 0; i < length; i++) {
                random += Math.random() > 0.5 ? '1' : '0';
            }
            return random;
        }

        // äºŒè¿›åˆ¶å­—ç¬¦ä¸²æŒ‰ä½å¼‚æˆ–è¿ç®—ï¼ˆå¯é€†æ“ä½œï¼‰
        function binaryXor(bin1, bin2) {
            let result = '';
            for (let i = 0; i < bin1.length; i++) {
                result += (parseInt(bin1[i]) ^ parseInt(bin2[i])).toString();
            }
            return result;
        }

        // äºŒè¿›åˆ¶è½¬åå…­è¿›åˆ¶
        function binaryToHex(binary) {
            let hex = '';
            for (let i = 0; i < binary.length; i += 4) {
                const nibble = binary.substr(i, 4);
                hex += parseInt(nibble, 2).toString(16).padStart(1, '0').toUpperCase();
            }
            return hex;
        }

        // åå…­è¿›åˆ¶è½¬äºŒè¿›åˆ¶
        function hexToBinary(hex) {
            let binary = '';
            for (let i = 0; i < hex.length; i++) {
                const nibble = parseInt(hex[i], 16).toString(2).padStart(4, '0');
                binary += nibble;
            }
            return binary;
        }

        // åå…­è¿›åˆ¶è½¬åè¿›åˆ¶æ•°ç»„
        function hexToDecimalArray(hex) {
            const decimals = [];
            for (let i = 0; i < hex.length; i += 2) {
                const byte = hex.substr(i, 2);
                decimals.push(parseInt(byte, 16));
            }
            return decimals;
        }

        // åè¿›åˆ¶æ•°ç»„è½¬åå…­è¿›åˆ¶
        function decimalArrayToHex(decimals) {
            let hex = '';
            for (let decimal of decimals) {
                hex += decimal.toString(16).padStart(2, '0').toUpperCase();
            }
            return hex;
        }

        // æ‰¾åˆ°æ¯”nå¤§çš„æœ€å°å¹³æ–¹æ•°
        function findNextSquareNumber(n) {
            const sqrt = Math.sqrt(n);
            const size = Math.ceil(sqrt);
            return size;
        }

        // è¡¥0åˆ°å¹³æ–¹æ•°ï¼ˆåªè¡¥åˆ°æ¯”åŸæ•°å¤§çš„å¹³æ–¹æ•°ï¼‰
        function padToNextSquare(decimalArray) {
            const n = decimalArray.length;
            const size = findNextSquareNumber(n);
            const targetLength = size * size;
            
            const padded = [...decimalArray];
            const zerosToAdd = targetLength - n;
            
            for (let i = 0; i < zerosToAdd; i++) {
                padded.push(0);
            }
            
            return {
                array: padded,
                size: size,
                originalLength: n,
                paddedLength: targetLength,
                zerosAdded: zerosToAdd
            };
        }

        // ä»è¡¥0åçš„æ•°ç»„ä¸­ç§»é™¤è¡¥çš„0
        function removePadding(paddedArray, originalLength) {
            return paddedArray.slice(0, originalLength);
        }

        // å°†ä¸€ç»´æ•°ç»„è½¬æ¢ä¸ºäºŒç»´çŸ©é˜µ
        function arrayToMatrix(arr, size) {
            const matrix = [];
            for (let i = 0; i < size; i++) {
                const row = [];
                for (let j = 0; j < size; j++) {
                    row.push(arr[i * size + j]);
                }
                matrix.push(row);
            }
            return matrix;
        }

        // å°†äºŒç»´çŸ©é˜µè½¬æ¢ä¸ºä¸€ç»´æ•°ç»„
        function matrixToArray(matrix) {
            const arr = [];
            const size = matrix.length;
            for (let i = 0; i < size; i++) {
                for (let j = 0; j < size; j++) {
                    arr.push(matrix[i][j]);
                }
            }
            return arr;
        }

        // ç”Ÿæˆç®€å•å“ˆå¸Œ
        function simpleHash(str) {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            return Math.abs(hash).toString(16).padStart(8, '0').toUpperCase();
        }

        // è®¡ç®—æ•°æ®ç»Ÿè®¡ä¿¡æ¯
        function calculateStatistics(data) {
            const sorted = [...data].sort((a, b) => a - b);
            const n = data.length;
            
            const sum = data.reduce((a, b) => a + b, 0);
            const mean = sum / n;
            
            const variance = data.reduce((a, b) => a + Math.pow(b - mean, 2), 0) / n;
            const stdDev = Math.sqrt(variance);
            
            const median = n % 2 === 0 
                ? (sorted[n/2 - 1] + sorted[n/2]) / 2
                : sorted[Math.floor(n/2)];
            
            const freq = {};
            data.forEach(val => freq[val] = (freq[val] || 0) + 1);
            let mode = 0;
            let maxFreq = 0;
            for (const val in freq) {
                if (freq[val] > maxFreq) {
                    maxFreq = freq[val];
                    mode = parseInt(val);
                }
            }
            
            const min = Math.min(...data);
            const max = Math.max(...data);
            
            const nonZero = data.filter(val => val !== 0).length;
            const zero = data.filter(val => val === 0).length;
            const zeroRatio = (zero / n * 100).toFixed(2);
            
            const entropy = calculateEntropy(data);
            const dataDensity = (nonZero / n * 100).toFixed(2);
            
            return {
                mean: mean,
                stdDev: stdDev,
                median: median,
                mode: mode,
                min: min,
                max: max,
                nonZero: nonZero,
                zero: zero,
                zeroRatio: zeroRatio,
                entropy: entropy,
                dataDensity: dataDensity
            };
        }

        // è®¡ç®—æ•°æ®ç†µ
        function calculateEntropy(data) {
            const frequencies = {};
            const total = data.length;
            
            data.forEach(value => {
                frequencies[value] = (frequencies[value] || 0) + 1;
            });
            
            let entropy = 0;
            for (const value in frequencies) {
                const probability = frequencies[value] / total;
                entropy -= probability * Math.log2(probability);
            }
            
            return entropy.toFixed(4);
        }

        // ç»˜åˆ¶ç›´æ–¹å›¾
        function drawHistogram(data) {
            const chart = document.getElementById('histogramChart');
            chart.innerHTML = '';
            
            const bins = 16;
            const binSize = 256 / bins;
            const histogram = new Array(bins).fill(0);
            
            data.forEach(value => {
                const binIndex = Math.min(Math.floor(value / binSize), bins - 1);
                histogram[binIndex]++;
            });
            
            const maxCount = Math.max(...histogram);
            
            histogram.forEach((count, index) => {
                const bar = document.createElement('div');
                bar.className = 'bar';
                const height = maxCount > 0 ? (count / maxCount * 100) : 0;
                bar.style.height = `${height}%`;
                bar.title = `[${Math.floor(index * binSize)}-${Math.floor((index + 1) * binSize)}]: ${count}ä¸ªå€¼`;
                chart.appendChild(bar);
            });
        }

        // ç»˜åˆ¶æ³¢å½¢
        function drawWaveform() {
            const canvas = document.getElementById('waveformCanvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = 500;
            canvas.height = 350;
            
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.clearRect(0, 0, width, height);
            
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
            ctx.lineWidth = 1;
            
            for (let x = 0; x < width; x += 50) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, height);
                ctx.stroke();
            }
            
            for (let y = 0; y < height; y += 50) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(width, y);
                ctx.stroke();
            }
            
            if (encryptionData.decimalSequence.length > 0) {
                const data = encryptionData.decimalSequence;
                const spacing = Math.max(1, width / data.length);
                
                ctx.beginPath();
                ctx.strokeStyle = '#00d4ff';
                ctx.lineWidth = 2;
                
                for (let i = 0; i < data.length; i++) {
                    const x = i * spacing;
                    const y = height / 2 - (data[i] - 128) * (height / 300);
                    
                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                ctx.stroke();
                
                ctx.fillStyle = '#00d4ff';
                const pointCount = Math.min(100, data.length);
                const pointStep = Math.max(1, Math.floor(data.length / pointCount));
                for (let i = 0; i < data.length; i += pointStep) {
                    const x = i * spacing;
                    const y = height / 2 - (data[i] - 128) * (height / 300);
                    ctx.beginPath();
                    ctx.arc(x, y, 3, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
                ctx.fillRect(10, 10, 200, 90);
                
                ctx.fillStyle = '#ffffff';
                ctx.font = '12px Arial';
                ctx.fillText(`æ•°æ®ç‚¹æ•°: ${data.length}`, 20, 30);
                ctx.fillText(`æ•°å€¼èŒƒå›´: ${Math.min(...data)} - ${Math.max(...data)}`, 20, 50);
                ctx.fillText(`å¹³å‡å€¼: ${(data.reduce((a,b)=>a+b)/data.length).toFixed(2)}`, 20, 70);
                ctx.fillText(`æ ‡å‡†å·®: ${Math.sqrt(data.reduce((a,b)=>a+Math.pow(b-data.reduce((a,b)=>a+b)/data.length,2),0)/data.length).toFixed(2)}`, 20, 90);
            }
        }

        // ç»˜åˆ¶çŸ©é˜µå›¾åƒ
        function drawMatrixImage() {
            const canvas = document.getElementById('matrixCanvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = 500;
            canvas.height = 350;
            
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.clearRect(0, 0, width, height);
            
            if (!encryptionData.matrixData || encryptionData.matrixSize === 0) return;
            
            const matrix = encryptionData.matrixData;
            const size = encryptionData.matrixSize;
            
            const pixelSize = Math.min(width, height) / size * encryptionData.zoomLevel;
            
            ctx.fillStyle = '#000000';
            ctx.fillRect(0, 0, width, height);
            
            for (let i = 0; i < size; i++) {
                for (let j = 0; j < size; j++) {
                    const value = matrix[i][j];
                    
                    let color;
                    if (encryptionData.heatmapMode) {
                        const intensity = value / 255;
                        if (intensity < 0.33) {
                            const r = Math.floor(0 + (intensity * 3) * 255);
                            color = `rgb(${r}, 0, 0)`;
                        } else if (intensity < 0.66) {
                            const g = Math.floor((intensity - 0.33) * 3 * 255);
                            color = `rgb(255, ${g}, 0)`;
                        } else {
                            const b = Math.floor((intensity - 0.66) * 3 * 255);
                            color = `rgb(255, 255, ${b})`;
                        }
                    } else {
                        const grayValue = value;
                        color = `rgb(${grayValue}, ${grayValue}, ${grayValue})`;
                    }
                    
                    ctx.fillStyle = color;
                    
                    const x = (width - size * pixelSize) / 2 + j * pixelSize;
                    const y = (height - size * pixelSize) / 2 + i * pixelSize;
                    
                    ctx.fillRect(x, y, pixelSize, pixelSize);
                    
                    if (encryptionData.showGrid && pixelSize > 3) {
                        ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
                        ctx.lineWidth = 0.5;
                        ctx.strokeRect(x, y, pixelSize, pixelSize);
                    }
                }
            }
            
            ctx.strokeStyle = encryptionData.heatmapMode ? '#ff9900' : '#00d4ff';
            ctx.lineWidth = 2;
            const borderX = (width - size * pixelSize) / 2;
            const borderY = (height - size * pixelSize) / 2;
            ctx.strokeRect(borderX, borderY, size * pixelSize, size * pixelSize);
            
            ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
            ctx.fillRect(10, 10, 180, 90);
            
            ctx.fillStyle = '#ffffff';
            ctx.font = '12px Arial';
            ctx.fillText(`çŸ©é˜µ: ${size}Ã—${size}`, 20, 30);
            ctx.fillText(`åƒç´ å¤§å°: ${pixelSize.toFixed(1)}px`, 20, 50);
            ctx.fillText(`ç¼©æ”¾: ${encryptionData.zoomLevel.toFixed(1)}x`, 20, 70);
            ctx.fillText(`æ¨¡å¼: ${encryptionData.heatmapMode ? 'çƒ­åŠ›å›¾' : 'ç°åº¦å›¾'}`, 20, 90);
        }

        // ä¸‹è½½å›¾åƒ
        function downloadImage() {
            const canvas = document.getElementById('matrixCanvas');
            const link = document.createElement('a');
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
            link.download = `matrix-${timestamp}.png`;
            link.href = canvas.toDataURL('image/png');
            link.click();
        }

        // ä¸‹è½½åŠ å¯†æ•°æ®
        function downloadEncryptionData() {
            const data = {
                originalText: encryptionData.originalText,
                finalHex: encryptionData.finalHex,
                matrixSize: encryptionData.matrixSize,
                paddedLength: encryptionData.paddedSequence.length,
                originalLength: encryptionData.decimalSequence.length,
                randomKey: encryptionData.randomBinary,
                keyId: encryptionData.keyId,
                timestamp: new Date().toISOString(),
                algorithm: "GB2312-XOR-Matrix"
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const link = document.createElement('a');
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
            link.download = `encryption-data-${timestamp}.json`;
            link.href = URL.createObjectURL(blob);
            link.click();
            
            setTimeout(() => URL.revokeObjectURL(link.href), 100);
        }

        // æ”¾å¤§
        function zoomIn() {
            encryptionData.zoomLevel = Math.min(encryptionData.zoomLevel + 0.5, 5);
            drawMatrixImage();
        }

        // ç¼©å°
        function zoomOut() {
            encryptionData.zoomLevel = Math.max(encryptionData.zoomLevel - 0.5, 0.5);
            drawMatrixImage();
        }

        // åˆ‡æ¢ç½‘æ ¼æ˜¾ç¤º
        function toggleGrid() {
            encryptionData.showGrid = !encryptionData.showGrid;
            drawMatrixImage();
        }

        // åˆ‡æ¢çƒ­åŠ›å›¾æ¨¡å¼
        function toggleHeatmap() {
            encryptionData.heatmapMode = !encryptionData.heatmapMode;
            drawMatrixImage();
        }

        // å¤„ç†æ–‡ä»¶ä¸Šä¼ 
        function handleFileUpload(files) {
            if (files.length === 0) return;
            
            const file = files[0];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                const result = e.target.result;
                
                if (file.type === 'application/json') {
                    // å¤„ç†JSONåŠ å¯†æ•°æ®æ–‡ä»¶
                    try {
                        const data = JSON.parse(result);
                        loadEncryptionDataFromObject(data);
                    } catch (error) {
                        alert('æ— æ³•è§£æJSONæ–‡ä»¶: ' + error.message);
                    }
                } else if (file.type.startsWith('image/')) {
                    // å¤„ç†å›¾åƒæ–‡ä»¶
                    loadImageFromDataURL(result);
                } else {
                    alert('ä¸æ”¯æŒçš„æ–‡ä»¶æ ¼å¼');
                }
            };
            
            if (file.type === 'application/json') {
                reader.readAsText(file);
            } else {
                reader.readAsDataURL(file);
            }
        }

        // åŠ è½½åŠ å¯†æ•°æ®
        function loadEncryptionData() {
            alert('è¯·ä¸Šä¼ ä¹‹å‰ä¸‹è½½çš„åŠ å¯†æ•°æ®æ–‡ä»¶(.json)');
        }

        // ä»å¯¹è±¡åŠ è½½åŠ å¯†æ•°æ®
        function loadEncryptionDataFromObject(data) {
            toggleDecryptLoading(true);
            updateStatus("æ­£åœ¨åŠ è½½åŠ å¯†æ•°æ®...");
            
            setTimeout(() => {
                try {
                    decryptionData.loadedImage = null;
                    decryptionData.extractedMatrix = null;
                    
                    // æ˜¾ç¤ºåŠ è½½çš„å›¾åƒ
                    const canvas = document.getElementById('loadedImageCanvas');
                    const ctx = canvas.getContext('2d');
                    canvas.width = 400;
                    canvas.height = 300;
                    
                    ctx.fillStyle = '#000000';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    ctx.fillStyle = '#ffffff';
                    ctx.font = '20px Arial';
                    ctx.fillText('JSONæ•°æ®å·²åŠ è½½', 100, 150);
                    
                    // æå–æ•°æ®
                    const finalHex = data.finalHex;
                    const randomKey = data.randomKey;
                    
                    // åˆ†ç¦»åŠ å¯†æ•°æ®å’Œå¯†é’¥
                    const halfLength = finalHex.length / 2;
                    const encryptedHex = finalHex.substring(0, halfLength);
                    const keyHex = finalHex.substring(halfLength);
                    
                    // éªŒè¯å¯†é’¥
                    const extractedKeyBinary = hexToBinary(keyHex);
                    const keyMatch = extractedKeyBinary === randomKey;
                    
                    // è§£å¯†è¿‡ç¨‹
                    const encryptedBinary = hexToBinary(encryptedHex);
                    const decryptedBinary = binaryXor(encryptedBinary, randomKey);
                    const decryptedBytes = binaryToBytes(decryptedBinary);
                    const decryptedText = gb2312ToString(decryptedBytes);
                    
                    // æ›´æ–°è§£å¯†ç»“æœ
                    decryptionData.decryptedText = decryptedText;
                    decryptionData.decryptionKey = randomKey;
                    decryptionData.success = true;
                    
                    // æ˜¾ç¤ºè§£å¯†ç»“æœ
                    document.getElementById('decryptedText').textContent = decryptedText;
                    document.getElementById('decryptKeyLength').textContent = randomKey.length;
                    document.getElementById('decryptKeyHex').textContent = binaryToHex(randomKey).substring(0, 50) + '...';
                    document.getElementById('keyMatchStatus').textContent = keyMatch ? 'åŒ¹é… âœ“' : 'ä¸åŒ¹é… âœ—';
                    document.getElementById('keyMatchStatus').className = keyMatch ? 'match' : 'mismatch';
                    
                    // æ˜¾ç¤ºè§£å¯†è¿‡ç¨‹
                    let processText = `1. ä»æœ€ç»ˆHexä¸­åˆ†ç¦»åŠ å¯†æ•°æ®å’Œå¯†é’¥\n`;
                    processText += `   - åŠ å¯†æ•°æ®Hexé•¿åº¦: ${encryptedHex.length}\n`;
                    processText += `   - å¯†é’¥Hexé•¿åº¦: ${keyHex.length}\n`;
                    processText += `2. å°†Hexè½¬æ¢ä¸ºäºŒè¿›åˆ¶\n`;
                    processText += `3. ä½¿ç”¨å¼‚æˆ–è¿ç®—è§£å¯†: åŠ å¯†äºŒè¿›åˆ¶ âŠ• å¯†é’¥äºŒè¿›åˆ¶\n`;
                    processText += `4. å°†è§£å¯†åçš„äºŒè¿›åˆ¶è½¬æ¢ä¸ºå­—èŠ‚\n`;
                    processText += `5. ä½¿ç”¨GB2312è§£ç ä¸ºæ–‡æœ¬\n`;
                    processText += `6. è§£å¯†ç»“æœ: ${decryptedText.length}ä¸ªå­—ç¬¦`;
                    
                    document.getElementById('decryptProcess').textContent = processText;
                    
                    // æ˜¾ç¤ºè§£å¯†ç»“æœåŒºåŸŸ
                    document.getElementById('decryptionResult').style.display = 'block';
                    
                    updateStatus("è§£å¯†å®Œæˆ!");
                    toggleDecryptLoading(false);
                    
                    // æ›´æ–°å¯¹æ¯”æ ‡ç­¾é¡µ
                    updateComparison();
                    
                } catch (error) {
                    alert('è§£å¯†å¤±è´¥: ' + error.message);
                    toggleDecryptLoading(false);
                }
            }, 500);
        }

        // åŠ è½½å›¾åƒæ•°æ®
        function loadImageData() {
            alert('è¯·ä¸Šä¼ ä¹‹å‰ä¸‹è½½çš„çŸ©é˜µå›¾åƒæ–‡ä»¶(.png)');
        }

        // ä»DataURLåŠ è½½å›¾åƒ
        function loadImageFromDataURL(dataURL) {
            toggleDecryptLoading(true);
            updateStatus("æ­£åœ¨åŠ è½½å›¾åƒæ•°æ®...");
            
            const img = new Image();
            img.onload = function() {
                // æ˜¾ç¤ºåŠ è½½çš„å›¾åƒ
                const canvas = document.getElementById('loadedImageCanvas');
                const ctx = canvas.getContext('2d');
                canvas.width = 400;
                canvas.height = 300;
                
                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                
                // ä»å›¾åƒä¸­æå–åƒç´ æ•°æ®
                extractMatrixFromImage(img);
            };
            
            img.onerror = function() {
                alert('æ— æ³•åŠ è½½å›¾åƒ');
                toggleDecryptLoading(false);
            };
            
            img.src = dataURL;
        }

        // ä»å›¾åƒä¸­æå–çŸ©é˜µ
        function extractMatrixFromImage(img) {
            setTimeout(() => {
                try {
                    // åˆ›å»ºä¸´æ—¶canvaså¤„ç†å›¾åƒ
                    const tempCanvas = document.createElement('canvas');
                    const tempCtx = tempCanvas.getContext('2d');
                    tempCanvas.width = img.width;
                    tempCanvas.height = img.height;
                    tempCtx.drawImage(img, 0, 0);
                    
                    // è·å–å›¾åƒæ•°æ®
                    const imageData = tempCtx.getImageData(0, 0, tempCanvas.width, tempCanvas.height);
                    const data = imageData.data;
                    
                    // ç®€å•çš„çŸ©é˜µæå–ï¼ˆè¿™é‡Œç®€åŒ–å¤„ç†ï¼Œå®é™…éœ€è¦æ›´å¤æ‚çš„ç®—æ³•ï¼‰
                    // å‡è®¾å›¾åƒæ˜¯ç°åº¦å›¾ï¼Œåªå–çº¢è‰²é€šé“
                    const extractedSequence = [];
                    for (let i = 0; i < data.length; i += 4) {
                        extractedSequence.push(data[i]); // çº¢è‰²é€šé“å€¼
                    }
                    
                    // ç”±äºæˆ‘ä»¬ä¸çŸ¥é“åŸå§‹çŸ©é˜µå¤§å°ï¼Œè¿™é‡Œå‡è®¾æ˜¯æ­£æ–¹å½¢
                    const size = Math.floor(Math.sqrt(extractedSequence.length));
                    const matrix = arrayToMatrix(extractedSequence.slice(0, size * size), size);
                    
                    decryptionData.extractedMatrix = matrix;
                    decryptionData.extractedSequence = extractedSequence.slice(0, size * size);
                    
                    // ç»˜åˆ¶æå–çš„çŸ©é˜µ
                    drawExtractedMatrix(matrix);
                    
                    updateStatus("å›¾åƒæ•°æ®æå–å®Œæˆ!");
                    toggleDecryptLoading(false);
                    
                } catch (error) {
                    alert('å›¾åƒå¤„ç†å¤±è´¥: ' + error.message);
                    toggleDecryptLoading(false);
                }
            }, 500);
        }

        // ç»˜åˆ¶æå–çš„çŸ©é˜µ
        function drawExtractedMatrix(matrix) {
            const canvas = document.getElementById('extractedMatrixCanvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = 400;
            canvas.height = 300;
            
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.clearRect(0, 0, width, height);
            
            if (!matrix || matrix.length === 0) return;
            
            const size = matrix.length;
            const pixelSize = Math.min(width, height) / size;
            
            for (let i = 0; i < size; i++) {
                for (let j = 0; j < size; j++) {
                    const value = matrix[i][j];
                    const grayValue = value;
                    
                    ctx.fillStyle = `rgb(${grayValue}, ${grayValue}, ${grayValue})`;
                    
                    const x = j * pixelSize;
                    const y = i * pixelSize;
                    
                    ctx.fillRect(x, y, pixelSize, pixelSize);
                }
            }
        }

        // ä»çŸ©é˜µè§£å¯†
        function decryptFromMatrix() {
            if (!decryptionData.extractedMatrix) {
                alert('è¯·å…ˆåŠ è½½å›¾åƒæ•°æ®');
                return;
            }
            
            toggleDecryptLoading(true);
            updateStatus("æ­£åœ¨ä»çŸ©é˜µè§£å¯†...");
            
            setTimeout(() => {
                try {
                    // è¿™é‡Œéœ€è¦å®ç°ä»çŸ©é˜µè¿˜åŸæ•°æ®çš„å®Œæ•´ç®—æ³•
                    // ç”±äºæˆ‘ä»¬ä¸çŸ¥é“åŸå§‹æ•°æ®çš„é•¿åº¦ï¼Œè¿™ä¸ªä»»åŠ¡æ¯”è¾ƒå¤æ‚
                    // å®é™…åº”ç”¨ä¸­ï¼Œéœ€è¦å°†çŸ©é˜µå¤§å°ã€åŸå§‹é•¿åº¦ç­‰ä¿¡æ¯ç¼–ç åœ¨å›¾åƒä¸­
                    
                    alert('ä»çº¯å›¾åƒè§£å¯†éœ€è¦é¢å¤–çš„å…ƒæ•°æ®ä¿¡æ¯ã€‚\nè¯·ä½¿ç”¨ä¸‹è½½çš„åŠ å¯†æ•°æ®æ–‡ä»¶(.json)è¿›è¡Œè§£å¯†ã€‚');
                    
                    toggleDecryptLoading(false);
                    
                } catch (error) {
                    alert('è§£å¯†å¤±è´¥: ' + error.message);
                    toggleDecryptLoading(false);
                }
            }, 500);
        }

        // æ›´æ–°å¯¹æ¯”ä¿¡æ¯
        function updateComparison() {
            if (!encryptionData.originalText || !decryptionData.decryptedText) return;
            
            const original = encryptionData.originalText;
            const decrypted = decryptionData.decryptedText;
            
            document.getElementById('compareOriginalLength').textContent = `${original.length} å­—ç¬¦`;
            document.getElementById('compareDecryptedLength').textContent = `${decrypted.length} å­—ç¬¦`;
            
            const match = original === decrypted;
            document.getElementById('compareMatchStatus').textContent = match ? 'å®Œå…¨åŒ¹é… âœ“' : 'ä¸åŒ¹é… âœ—';
            document.getElementById('compareMatchStatus').className = match ? 'match' : 'mismatch';
            
            const originalHash = simpleHash(original);
            const decryptedHash = simpleHash(decrypted);
            
            document.getElementById('compareOriginalHash').textContent = originalHash;
            document.getElementById('compareDecryptedHash').textContent = decryptedHash;
            
            const hashMatch = originalHash === decryptedHash;
            document.getElementById('compareHashMatch').textContent = hashMatch ? 'åŒ¹é… âœ“' : 'ä¸åŒ¹é… âœ—';
            document.getElementById('compareHashMatch').className = hashMatch ? 'match' : 'mismatch';
            
            // å­—ç¬¦çº§å¯¹æ¯”
            let comparisonText = '';
            const maxLength = Math.max(original.length, decrypted.length);
            
            for (let i = 0; i < maxLength; i++) {
                const origChar = i < original.length ? original[i] : ' ';
                const decrChar = i < decrypted.length ? decrypted[i] : ' ';
                const matchChar = origChar === decrChar ? 'âœ“' : 'âœ—';
                
                comparisonText += `ä½ç½® ${i}: '${origChar}' vs '${decrChar}' ${matchChar}\n`;
            }
            
            document.getElementById('charComparison').textContent = comparisonText;
        }

        // ä¸»åŠ å¯†å‡½æ•°
        async function encryptText() {
            try {
                updateStepIndicator(1);
                updateStatus("æ­£åœ¨è·å–è¾“å…¥æ–‡æœ¬...");
                toggleLoading(true);
                
                const inputText = document.getElementById('inputText').value;
                encryptionData.originalText = inputText;
                
                document.getElementById('originalText').textContent = inputText;
                
                // GB2312ç¼–ç 
                updateStepIndicator(2);
                updateStatus("æ­£åœ¨è¿›è¡ŒGB2312ç¼–ç ...");
                await new Promise(resolve => setTimeout(resolve, 300));
                
                encryptionData.gb2312Bytes = stringToGB2312(inputText);
                const hexString = Array.from(encryptionData.gb2312Bytes)
                    .map(b => b.toString(16).padStart(2, '0').toUpperCase())
                    .join(' ');
                document.getElementById('gb2312Encoding').textContent = hexString.substring(0, 100) + (hexString.length > 100 ? '...' : '');
                
                // è½¬æ¢ä¸ºäºŒè¿›åˆ¶
                encryptionData.binaryString = bytesToBinary(encryptionData.gb2312Bytes);
                
                // ç”ŸæˆéšæœºäºŒè¿›åˆ¶å¯†é’¥
                updateStepIndicator(3);
                updateStatus("æ­£åœ¨ç”Ÿæˆéšæœºå¯†é’¥å¹¶è¿›è¡ŒäºŒè¿›åˆ¶åŠ å¯†...");
                await new Promise(resolve => setTimeout(resolve, 300));
                
                encryptionData.randomBinary = generateRandomBinary(encryptionData.binaryString.length);
                document.getElementById('randomKey').textContent = 
                    encryptionData.randomBinary.substring(0, 100) + '...';
                
                // æŒ‰ä½å¼‚æˆ–è¿ç®—ï¼ˆå¯é€†æ“ä½œï¼‰
                encryptionData.xorResult = binaryXor(encryptionData.binaryString, encryptionData.randomBinary);
                
                // è½¬æ¢ä¸ºåå…­è¿›åˆ¶
                const xorHex = binaryToHex(encryptionData.xorResult);
                document.getElementById('xorResult').textContent = xorHex.substring(0, 100) + '...';
                
                // æ·»åŠ éšæœºå¯†é’¥çš„åå…­è¿›åˆ¶
                const randomHex = binaryToHex(encryptionData.randomBinary);
                encryptionData.finalHex = xorHex + randomHex;
                document.getElementById('finalEncrypted').textContent = 
                    encryptionData.finalHex.substring(0, 100) + '...';
                
                // è½¬æ¢ä¸ºåè¿›åˆ¶åºåˆ—å¹¶è¿›è¡ŒçŸ©é˜µè½¬æ¢
                updateStepIndicator(4);
                updateStatus("æ­£åœ¨ç”Ÿæˆåè¿›åˆ¶åºåˆ—å¹¶è½¬æ¢ä¸ºçŸ©é˜µå›¾åƒ...");
                await new Promise(resolve => setTimeout(resolve, 300));
                
                encryptionData.decimalSequence = hexToDecimalArray(encryptionData.finalHex);
                document.getElementById('decimalSequence').textContent = 
                    encryptionData.decimalSequence.slice(0, 20).join(', ') + '...';
                
                // è¡¥0åˆ°æ¯”å½“å‰ä¸ªæ•°å¤§çš„å¹³æ–¹æ•°
                const paddedResult = padToNextSquare(encryptionData.decimalSequence);
                encryptionData.paddedSequence = paddedResult.array;
                encryptionData.matrixSize = paddedResult.size;
                
                document.getElementById('paddedSequenceDisplay').textContent = 
                    encryptionData.paddedSequence.slice(0, 20).join(', ') + '...';
                
                // è½¬æ¢ä¸ºçŸ©é˜µ
                encryptionData.matrixData = arrayToMatrix(encryptionData.paddedSequence, encryptionData.matrixSize);
                
                // æ˜¾ç¤ºçŸ©é˜µä¿¡æ¯
                const nearestSquare = paddedResult.size * paddedResult.size;
                document.getElementById('matrixInfo').textContent = 
                    `åŸå§‹ç‚¹æ•°: ${paddedResult.originalLength}, æœ€è¿‘å¹³æ–¹æ•°: ${nearestSquare}, çŸ©é˜µç»´åº¦: ${encryptionData.matrixSize}Ã—${encryptionData.matrixSize}`;
                
                // æ›´æ–°ä¿¡æ¯é¢æ¿
                document.getElementById('dataCount').textContent = paddedResult.originalLength;
                document.getElementById('nearestSquare').textContent = nearestSquare;
                document.getElementById('paddedCount').textContent = paddedResult.paddedLength;
                document.getElementById('matrixSize').textContent = `${encryptionData.matrixSize}Ã—${encryptionData.matrixSize}`;
                document.getElementById('zerosAdded').textContent = paddedResult.zerosAdded;
                document.getElementById('imageSize').textContent = `${encryptionData.matrixSize}Ã—${encryptionData.matrixSize} åƒç´ `;
                document.getElementById('pixelCount').textContent = paddedResult.paddedLength;
                
                // è®¡ç®—ç»Ÿè®¡æ•°æ®
                const stats = calculateStatistics(encryptionData.paddedSequence);
                
                document.getElementById('avgGray').textContent = stats.mean.toFixed(2);
                document.getElementById('minMax').textContent = `${stats.min}/${stats.max}`;
                document.getElementById('stdDev').textContent = stats.stdDev.toFixed(2);
                document.getElementById('dataEntropy').textContent = stats.entropy;
                document.getElementById('fillRatio').textContent = `${((paddedResult.originalLength / paddedResult.paddedLength) * 100).toFixed(2)}%`;
                document.getElementById('dataDensity').textContent = `${stats.dataDensity}%`;
                
                // æ›´æ–°åˆ†æé¢æ¿
                document.getElementById('nonZeroCount').textContent = stats.nonZero;
                document.getElementById('zeroCount').textContent = stats.zero;
                document.getElementById('zeroRatio').textContent = `${stats.zeroRatio}%`;
                document.getElementById('medianValue').textContent = stats.median.toFixed(2);
                document.getElementById('modeValue').textContent = stats.mode;
                
                // æ›´æ–°å¯†é’¥ä¿¡æ¯
                encryptionData.encryptionKey = encryptionData.randomBinary;
                encryptionData.keyId = simpleHash(encryptionData.randomBinary);
                encryptionData.timestamp = new Date().toISOString();
                
                document.getElementById('keyLength').textContent = encryptionData.randomBinary.length;
                document.getElementById('keyHex').textContent = binaryToHex(encryptionData.randomBinary).substring(0, 50) + '...';
                document.getElementById('keyHash').textContent = encryptionData.keyId;
                document.getElementById('keyId').textContent = encryptionData.keyId.substring(0, 8);
                
                // ç»˜åˆ¶ç›´æ–¹å›¾
                drawHistogram(encryptionData.paddedSequence);
                
                // æ›´æ–°æ•°æ®å¤§å°
                const dataSize = encryptionData.finalHex.length / 2;
                document.getElementById('dataSize').textContent = 
                    `æ•°æ®å¤§å°: ${dataSize.toFixed(2)} bytes`;
                
                // å®Œæˆ
                updateStatus("åŠ å¯†å’ŒçŸ©é˜µå›¾åƒè½¬æ¢å®Œæˆï¼");
                toggleLoading(false);
                
                // ç»˜åˆ¶å¯è§†åŒ–å’ŒçŸ©é˜µå›¾åƒ
                drawWaveform();
                drawMatrixImage();
                
            } catch (error) {
                console.error('åŠ å¯†è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯:', error);
                updateStatus("åŠ å¯†å¤±è´¥: " + error.message);
                toggleLoading(false);
            }
        }

        // é‡ç½®æ‰€æœ‰æ•°æ®
        function resetAll() {
            document.getElementById('inputText').value = '';
            encryptionData = {
                originalText: '',
                gb2312Bytes: null,
                binaryString: '',
                randomBinary: '',
                xorResult: '',
                finalHex: '',
                decimalSequence: [],
                paddedSequence: [],
                matrixData: null,
                matrixSize: 0,
                heatmapMode: false,
                zoomLevel: 1.5,
                showGrid: true,
                encryptionKey: null,
                keyId: '',
                timestamp: null
            };
            
            decryptionData = {
                loadedImage: null,
                extractedMatrix: null,
                extractedSequence: [],
                decryptedText: '',
                decryptionKey: null,
                success: false
            };
            
            // é‡ç½®æ˜¾ç¤º
            document.getElementById('originalText').textContent = 'ç­‰å¾…è¾“å…¥...';
            document.getElementById('gb2312Encoding').textContent = 'ç­‰å¾…å¤„ç†...';
            document.getElementById('randomKey').textContent = 'ç­‰å¾…ç”Ÿæˆ...';
            document.getElementById('xorResult').textContent = 'ç­‰å¾…è®¡ç®—...';
            document.getElementById('finalEncrypted').textContent = 'ç­‰å¾…è®¡ç®—...';
            document.getElementById('decimalSequence').textContent = 'ç­‰å¾…ç”Ÿæˆ...';
            document.getElementById('paddedSequenceDisplay').textContent = 'ç­‰å¾…è®¡ç®—...';
            document.getElementById('matrixInfo').textContent = 'ç­‰å¾…è®¡ç®—...';
            
            // é‡ç½®ä¿¡æ¯é¢æ¿
            document.getElementById('dataCount').textContent = '0';
            document.getElementById('nearestSquare').textContent = '0';
            document.getElementById('paddedCount').textContent = '0';
            document.getElementById('matrixSize').textContent = '0Ã—0';
            document.getElementById('zerosAdded').textContent = '0';
            document.getElementById('imageSize').textContent = '0Ã—0 åƒç´ ';
            document.getElementById('pixelCount').textContent = '0';
            document.getElementById('fillRatio').textContent = '0%';
            document.getElementById('dataDensity').textContent = '0%';
            document.getElementById('avgGray').textContent = '0';
            document.getElementById('minMax').textContent = '0/0';
            document.getElementById('stdDev').textContent = '0';
            document.getElementById('dataEntropy').textContent = '0';
            
            // é‡ç½®åˆ†æé¢æ¿
            document.getElementById('nonZeroCount').textContent = '0';
            document.getElementById('zeroCount').textContent = '0';
            document.getElementById('zeroRatio').textContent = '0%';
            document.getElementById('medianValue').textContent = '0';
            document.getElementById('modeValue').textContent = '0';
            
            // é‡ç½®å¯†é’¥ä¿¡æ¯
            document.getElementById('keyLength').textContent = '0';
            document.getElementById('keyHex').textContent = 'ç­‰å¾…ç”Ÿæˆ...';
            document.getElementById('keyHash').textContent = 'ç­‰å¾…ç”Ÿæˆ...';
            document.getElementById('keyId').textContent = 'ç­‰å¾…ç”Ÿæˆ...';
            
            // é‡ç½®è§£å¯†ç»“æœ
            document.getElementById('decryptionResult').style.display = 'none';
            document.getElementById('decryptedText').textContent = 'ç­‰å¾…è§£å¯†...';
            
            document.getElementById('dataSize').textContent = 'æ•°æ®å¤§å°: 0 bytes';
            document.getElementById('statusText').textContent = 'å‡†å¤‡å°±ç»ª';
            document.getElementById('progressFill').style.width = '0%';
            
            updateStepIndicator(1);
            
            // æ¸…ç©ºç”»å¸ƒ
            const waveformCanvas = document.getElementById('waveformCanvas');
            const waveformCtx = waveformCanvas.getContext('2d');
            waveformCtx.clearRect(0, 0, waveformCanvas.width, waveformCanvas.height);
            
            const matrixCanvas = document.getElementById('matrixCanvas');
            const matrixCtx = matrixCanvas.getContext('2d');
            matrixCtx.clearRect(0, 0, matrixCanvas.width, matrixCanvas.height);
            
            const loadedCanvas = document.getElementById('loadedImageCanvas');
            const loadedCtx = loadedCanvas.getContext('2d');
            loadedCtx.clearRect(0, 0, loadedCanvas.width, loadedCanvas.height);
            
            const extractedCanvas = document.getElementById('extractedMatrixCanvas');
            const extractedCtx = extractedCanvas.getContext('2d');
            extractedCtx.clearRect(0, 0, extractedCanvas.width, extractedCanvas.height);
            
            // æ¸…ç©ºç›´æ–¹å›¾
            document.getElementById('histogramChart').innerHTML = '';
            
            // æ¸…ç©ºå¯¹æ¯”ä¿¡æ¯
            document.getElementById('charComparison').textContent = 'ç­‰å¾…å¯¹æ¯”...';
        }

        // éšæœºç¤ºä¾‹
        function randomExample() {
            const examples = [
                "è¿™æ˜¯ä¸€ä¸ªåŠ å¯†æµ‹è¯•æ¶ˆæ¯ï¼",
                "Hello, ä¸–ç•Œ! 123 ABC",
                "çŸ©é˜µå›¾åƒè½¬æ¢æä¾›å¯è§†åŒ–åŠ å¯†",
                "ç½‘ç»œå®‰å…¨æ˜¯æ•°å­—åŒ–æ—¶ä»£çš„åŸºçŸ³",
                "äºŒè¿›åˆ¶åŠ å¯†æä¾›é¢å¤–çš„å®‰å…¨å±‚",
                "éšæœºåºåˆ—å¢å¼ºäº†åŠ å¯†çš„å¼ºåº¦",
                "åƒç´ å›¾åƒå¯ç”¨äºæ•°æ®éšè—å’ŒåŠ å¯†ä¼ è¾“",
                "è¡¥é›¶æ“ä½œä½¿æ•°æ®å½¢æˆå®Œç¾çš„æ­£æ–¹å½¢çŸ©é˜µ",
                "ç°åº¦å›¾åƒèƒ½å¤Ÿå¾ˆå¥½åœ°éšè—åŠ å¯†ä¿¡æ¯"
            ];
            
            const randomIndex = Math.floor(Math.random() * examples.length);
            document.getElementById('inputText').value = examples[randomIndex];
        }

        // é•¿æ–‡æœ¬æµ‹è¯•
        function testLongText() {
            const longText = `ç½‘ç»œå®‰å…¨æ˜¯å½“ä»Šæ•°å­—æ—¶ä»£çš„é‡è¦è®®é¢˜ã€‚éšç€äº’è”ç½‘çš„æ™®åŠå’Œä¿¡æ¯æŠ€æœ¯çš„å‘å±•ï¼Œç½‘ç»œæ”»å‡»å’Œæ•°æ®æ³„éœ²äº‹ä»¶é¢‘å‘ï¼Œç»™ä¸ªäººã€ä¼ä¸šä¹ƒè‡³å›½å®¶å¸¦æ¥äº†å·¨å¤§çš„æŸå¤±å’Œå¨èƒã€‚å› æ­¤ï¼ŒåŠ å¼ºç½‘ç»œå®‰å…¨çš„é˜²æŠ¤å’Œç®¡ç†æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚

åŠ å¯†æŠ€æœ¯ä½œä¸ºç½‘ç»œå®‰å…¨çš„æ ¸å¿ƒæŠ€æœ¯ä¹‹ä¸€ï¼Œé€šè¿‡å°†åŸå§‹æ•°æ®è½¬æ¢ä¸ºå¯†æ–‡ï¼Œç¡®ä¿æ•°æ®åœ¨ä¼ è¾“å’Œå­˜å‚¨è¿‡ç¨‹ä¸­çš„æœºå¯†æ€§ã€å®Œæ•´æ€§å’Œå¯ç”¨æ€§ã€‚ä¼ ç»Ÿçš„åŠ å¯†ç®—æ³•å¦‚DESã€AESç­‰å·²è¢«å¹¿æ³›åº”ç”¨äºå„ç§åœºæ™¯ï¼Œä½†éšç€è®¡ç®—èƒ½åŠ›çš„æå‡å’Œé‡å­è®¡ç®—çš„å‘å±•ï¼Œè¿™äº›ç®—æ³•é¢ä¸´ç€è¢«ç ´è§£çš„é£é™©ã€‚

å› æ­¤ï¼Œç ”ç©¶å’Œå‘å±•æ–°çš„åŠ å¯†æŠ€æœ¯ï¼Œå¦‚åŸºäºé‡å­åŠ›å­¦çš„é‡å­åŠ å¯†ã€åŸºäºç”Ÿç‰©ç‰¹å¾çš„ç”Ÿç‰©è¯†åˆ«åŠ å¯†ç­‰ï¼Œæˆä¸ºå½“å‰ç½‘ç»œå®‰å…¨é¢†åŸŸçš„çƒ­ç‚¹ã€‚è¿™äº›æ–°æŠ€æœ¯ä¸ä»…æä¾›äº†æ›´é«˜çš„å®‰å…¨æ€§ï¼Œè¿˜åœ¨æŸäº›ç‰¹å®šåœºæ™¯ä¸‹å…·æœ‰ç‹¬ç‰¹çš„ä¼˜åŠ¿ã€‚

æœ¬ç³»ç»Ÿå±•ç¤ºäº†ä¸€ç§åŸºäºç¼–ç è½¬æ¢å’ŒçŸ©é˜µå›¾åƒåŒ–çš„åŠ å¯†æ–¹æ³•ï¼Œå°†æ–‡æœ¬æ•°æ®è½¬æ¢ä¸ºç°åº¦å›¾åƒï¼Œä¸ºæ•°æ®åŠ å¯†å’Œéšè—æä¾›äº†æ–°çš„æ€è·¯ã€‚é€šè¿‡å°†åŠ å¯†æ•°æ®å¯è§†åŒ–ä¸ºå›¾åƒï¼Œä¸ä»…å¯ä»¥å¢å¼ºæ•°æ®çš„éšè”½æ€§ï¼Œè¿˜å¯ä»¥é€šè¿‡å›¾åƒå¤„ç†æŠ€æœ¯è¿›ä¸€æ­¥åŠ å¯†å’Œä¼ è¾“ã€‚

åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™ç§åŠ å¯†æ–¹æ³•å¯ä»¥ä¸å…¶ä»–åŠ å¯†æŠ€æœ¯ç»“åˆä½¿ç”¨ï¼Œå½¢æˆå¤šå±‚æ¬¡çš„å®‰å…¨é˜²æŠ¤ä½“ç³»ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥å…ˆä½¿ç”¨AESåŠ å¯†æ•°æ®ï¼Œå†å°†åŠ å¯†åçš„æ•°æ®è½¬æ¢ä¸ºå›¾åƒè¿›è¡Œä¼ è¾“ï¼Œæ¥æ”¶æ–¹å†é€šè¿‡åå‘è¿‡ç¨‹è§£å¯†ï¼Œä»è€Œæé«˜æ•°æ®çš„å®‰å…¨æ€§ã€‚

è¡¥é›¶æ“ä½œæ˜¯çŸ©é˜µè½¬æ¢çš„å…³é”®æ­¥éª¤ã€‚é€šè¿‡å°†æ•°æ®è¡¥é›¶åˆ°æ¯”åŸå§‹æ•°æ®ç‚¹æ•°å¤§çš„æœ€è¿‘å¹³æ–¹æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å½¢æˆä¸€ä¸ªå®Œç¾çš„æ­£æ–¹å½¢çŸ©é˜µã€‚è¿™ç§çŸ©é˜µå¯ä»¥å¾ˆå®¹æ˜“åœ°è½¬æ¢ä¸ºå›¾åƒåƒç´ ï¼Œä¾¿äºå­˜å‚¨å’Œä¼ è¾“ã€‚è¡¥é›¶æ“ä½œä¸ä»…ä¿è¯äº†æ•°æ®çš„å®Œæ•´æ€§ï¼Œè¿˜ä¸ºåç»­çš„å›¾åƒå¤„ç†æ“ä½œæä¾›äº†ä¾¿åˆ©ã€‚

çŸ©é˜µå›¾åƒåŠ å¯†å…·æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š
1. ç›´è§‚æ€§ï¼šåŠ å¯†æ•°æ®ä»¥å›¾åƒå½¢å¼å‘ˆç°ï¼Œä¾¿äºç†è§£å’Œåˆ†æ
2. éšè”½æ€§ï¼šåŠ å¯†ä¿¡æ¯éšè—åœ¨å›¾åƒåƒç´ ä¸­ï¼Œä¸æ˜“è¢«å¯Ÿè§‰
3. çµæ´»æ€§ï¼šå¯ä»¥é€šè¿‡è°ƒæ•´çŸ©é˜µå¤§å°å’Œè¡¥é›¶ç­–ç•¥æ¥æ§åˆ¶å›¾åƒå°ºå¯¸
4. å…¼å®¹æ€§ï¼šå›¾åƒæ ¼å¼å¹¿æ³›æ”¯æŒï¼Œæ˜“äºä¼ è¾“å’Œå­˜å‚¨

æ€»ä¹‹ï¼Œç½‘ç»œå®‰å…¨æ˜¯ä¸€ä¸ªæŒç»­å‘å±•çš„é¢†åŸŸï¼Œéœ€è¦ä¸æ–­åˆ›æ–°å’Œå®Œå–„ã€‚åªæœ‰é€šè¿‡æŠ€æœ¯ã€ç®¡ç†å’Œæ³•å¾‹ç­‰å¤šæ–¹é¢çš„åŠªåŠ›ï¼Œæ‰èƒ½æ„å»ºä¸€ä¸ªå®‰å…¨ã€å¯é çš„ç½‘ç»œç¯å¢ƒã€‚çŸ©é˜µå›¾åƒåŠ å¯†ä½œä¸ºä¸€ç§åˆ›æ–°çš„åŠ å¯†æ–¹æ³•ï¼Œä¸ºæ•°æ®å®‰å…¨æä¾›äº†æ–°çš„å¯èƒ½æ€§ã€‚`;

            document.getElementById('inputText').value = longText;
        }

        // åˆå§‹åŒ–
        window.onload = function() {
            updateStepIndicator(1);
            drawWaveform();
            drawMatrixImage();
            
            // æ·»åŠ é”®ç›˜å¿«æ·é”®
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 'Enter') {
                    encryptText();
                }
                if (e.key === 'Escape') {
                    resetAll();
                }
                if (e.key === '+' || e.key === '=') {
                    zoomIn();
                }
                if (e.key === '-' || e.key === '_') {
                    zoomOut();
                }
                if (e.key === 'g' || e.key === 'G') {
                    toggleGrid();
                }
                if (e.key === 'h' || e.key === 'H') {
                    toggleHeatmap();
                }
            });
        };
    </script>
</body>
</html>